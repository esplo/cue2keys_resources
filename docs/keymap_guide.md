# キーマップガイド

くっつきーのキーマップは[VIA](https://caniusevia.com/)という仕組みを使用しており、簡単かつ動的に設定を変更できます。
[REMAP](https://remap-keys.app/configure)などのブラウザベースのツールを使うと、特別なソフトウェアをインストールせずに好みのキーマップを設定できます。
このガイドでは、REMAPを使ったキーマップ設定方法を紹介します。

設定に必要なキーマップ定義ファイルは以下のリンクからダウンロードできます：

[via.json](../firmware/via.json)

## REMAPの使い方

### 準備

1. まずブラウザで[REMAP](https://remap-keys.app/)のウェブサイトを開きます
2. トップページの「キーボードをカスタマイズ」ボタンをクリックします

![remap_1](../img/remap_1.png)

3. くっつきーがPCに接続されていることを確認し、画面上部の「+ キーボード」ボタンを押します

![remap_2](../img/remap_2.png)

4. ブラウザに接続確認画面が表示されます。リストから「cue2keys」を選択して「Connect」をクリックします

![remap_3](../img/remap_3.png)

5. 定義ファイルの選択を求められるので、先ほどダウンロードした[via.json](../firmware/via.json)ファイルを選択します

![remap_4](../img/remap_4.png)

※ 読み込みに時間がかかる場合があります。読み込みが完了しない場合は、ブラウザをリロードして再試行すると解決することもあります。

読み込みが完了すると、接続されている全てのキーが表示された状態になります。

![remap_5](../img/remap_5.png)

### キーマップの編集方法

キーの設定を変更する方法は非常に簡単です：

1. 変更したいキーのアイコンをクリックします
2. 表示されるメニューから割り当てたい機能やキーを選択します

![remap_8](../img/remap_8.png)

画面左に表示されているレイヤーを切り替えることで、異なるレイヤーのキーマップも設定できます。
通常はレイヤー0で、レイヤー3はトラックボールを動かした際に自動で有効になるレイヤー、他は押したキーや状態によって有効になるレイヤーです。

![remap_9](../img/remap_9.png)

### キーの位置確認方法

どのキーがどの位置に対応しているかを確認するには、テストマトリクスモードの機能が便利です。
接続しているチャンネルやディップスイッチの設定によってキーの位置が変わる場合があるため、設定前に実際のキーの位置を確認することをおすすめします。

![remap_6](../img/remap_6.png)

### カスタムキーコードの設定

くっつきー独自の特殊な機能を持つキーコードも設定することができます。
これらの機能は「FUNCTIONS」タブの「VIA USER KEY」カテゴリにあります。
これらのキーを押すことで、トラックボールの角度調整やスピード設定など、様々な調整が可能になります。

詳細な機能リストは[カスタムキーコード一覧](./custom_keycodes.md)をご覧ください。

⚠️ 後半のカスタムキーコードはGUIで表示されませんので、キーコードを入力して指定してください。

![remap_7](../img/remap_7.png)

現在の設定値は、ペンダントのディスプレイ2ページ目以降で確認できます。

## キーマッピングの保存

REMAPにはアカウントを作成すると設定したキーマップを保存できる便利な機能があります。
ある程度設定が固まったら、アカウントを作成して保存しておくことをおすすめします。
次回設定を変更する際や、ファームウェアを更新した後に再設定する際に役立ちます。

## 備考

スターターキットには、最初から一般的なキーマップが設定されています。
しかし、自分の好みや使い方に合わせて自由に変更することができますので、快適に使えるよう調整してみてください。
